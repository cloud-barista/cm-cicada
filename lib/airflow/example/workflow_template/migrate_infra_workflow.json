{
  "spec_version": "1.0",
  "name": "migrate_infra_workflow",
  "data": {
    "description": "Migrate Server",
    "task_groups": [
      {
        "name": "migrate_infra",
        "description": "Migrate Server",
        "tasks": [
          {
            "name": "infra_migration",
            "task_component": "beetle_task_infra_migration",
            "request_body": "{\n  \"status\": \"\",\n  \"description\": \"This is a list of recommended target infrastructures. Please review and use them.\",\n  \"targetCloud\": {\n    \"csp\": \"azure\",\n    \"region\": \"koreacentral\"\n  },\n  \"targetVmInfra\": {\n    \"name\": \"mmci01\",\n    \"installMonAgent\": \"\",\n    \"label\": null,\n    \"systemLabel\": \"\",\n    \"description\": \"a recommended multi-cloud infrastructure\",\n    \"subGroups\": [\n      {\n        \"name\": \"migrated-cb95f7e4-570c-468c-af77-2263271bc138\",\n        \"subGroupSize\": \"\",\n        \"label\": {\n          \"sourceMachineId\": \"cb95f7e4-570c-468c-af77-2263271bc138\"\n        },\n        \"description\": \"a recommended virtual machine 01 for cb95f7e4-570c-468c-af77-2263271bc138\",\n        \"connectionName\": \"azure-koreacentral\",\n        \"specId\": \"azure+koreacentral+standard_d8ls_v6\",\n        \"imageId\": \"Canonical:0001-com-ubuntu-server-jammy:22_04-lts-gen2:22.04.202507300\",\n        \"vNetId\": \"mig-vnet-01\",\n        \"subnetId\": \"mig-subnet-01\",\n        \"securityGroupIds\": [\n          \"mig-sg-01\"\n        ],\n        \"sshKeyId\": \"mig-sshkey-01\",\n        \"dataDiskIds\": null\n      }\n    ],\n    \"postCommand\": {\n      \"userName\": \"\",\n      \"command\": null\n    },\n    \"policyOnPartialFailure\": \"\"\n  },\n  \"targetVNet\": {\n    \"name\": \"mig-vnet-01\",\n    \"connectionName\": \"azure-koreacentral\",\n    \"cidrBlock\": \"192.168.96.0/19\",\n    \"subnetInfoList\": [\n      {\n        \"name\": \"mig-subnet-01\",\n        \"ipv4_CIDR\": \"192.168.110.0/24\",\n        \"description\": \"a recommended subnet for migration\"\n      }\n    ],\n    \"description\": \"a recommended vNet for migration\"\n  },\n  \"targetSshKey\": {\n    \"name\": \"mig-sshkey-01\",\n    \"connectionName\": \"azure-koreacentral\",\n    \"description\": \"a SSH Key pair for migration (Note - provided ONLY once, MUST be downloaded\",\n    \"cspResourceId\": \"\",\n    \"fingerprint\": \"\",\n    \"username\": \"\",\n    \"verifiedUsername\": \"\",\n    \"publicKey\": \"\",\n    \"privateKey\": \"\"\n  },\n  \"targetVmSpecList\": [\n    {\n      \"id\": \"azure+koreacentral+standard_d8ls_v6\",\n      \"uid\": \"d2vs9k1b1a2s738u4o9g\",\n      \"cspSpecName\": \"Standard_D8ls_v6\",\n      \"name\": \"azure+koreacentral+standard_d8ls_v6\",\n      \"namespace\": \"system\",\n      \"connectionName\": \"azure-koreacentral\",\n      \"providerName\": \"azure\",\n      \"regionName\": \"koreacentral\",\n      \"regionLatitude\": 37.5665,\n      \"regionLongitude\": 126.978,\n      \"infraType\": \"vm\",\n      \"architecture\": \"x86_64\",\n      \"vCPU\": 8,\n      \"memoryGiB\": 15.625,\n      \"costPerHour\": -1,\n      \"evaluationScore01\": -1,\n      \"evaluationScore02\": -1,\n      \"evaluationScore03\": -1,\n      \"evaluationScore04\": -1,\n      \"evaluationScore05\": -1,\n      \"evaluationScore06\": -1,\n      \"evaluationScore07\": -1,\n      \"evaluationScore08\": -1,\n      \"evaluationScore09\": -1,\n      \"evaluationScore10\": -1,\n      \"rootDiskType\": \"\",\n      \"rootDiskSize\": \"0\",\n      \"systemLabel\": \"auto-gen\",\n      \"details\": [\n        {\n          \"key\": \"MaxDataDiskCount\",\n          \"value\": \"24\"\n        },\n        {\n          \"key\": \"MemoryInMB\",\n          \"value\": \"16384\"\n        },\n        {\n          \"key\": \"Name\",\n          \"value\": \"Standard_D8ls_v6\"\n        },\n        {\n          \"key\": \"NumberOfCores\",\n          \"value\": \"8\"\n        },\n        {\n          \"key\": \"OSDiskSizeInMB\",\n          \"value\": \"1047552\"\n        },\n        {\n          \"key\": \"ResourceDiskSizeInMB\",\n          \"value\": \"0\"\n        }\n      ]\n    }\n  ],\n  \"targetVmOsImageList\": [\n    {\n      \"namespace\": \"system\",\n      \"providerName\": \"azure\",\n      \"cspImageName\": \"Canonical:0001-com-ubuntu-server-jammy:22_04-lts-gen2:22.04.202507300\",\n      \"regionList\": [\n        \"common\"\n      ],\n      \"id\": \"Canonical:0001-com-ubuntu-server-jammy:22_04-lts-gen2:22.04.202507300\",\n      \"uid\": \"d2vsc1pb1a2s7392nc80\",\n      \"name\": \"Canonical:0001-com-ubuntu-server-jammy:22_04-lts-gen2:22.04.202507300\",\n      \"connectionName\": \"azure-australiacentral\",\n      \"infraType\": \"vm\",\n      \"fetchedTime\": \"2025.09.09 06:15:35 Tue\",\n      \"isKubernetesImage\": true,\n      \"isBasicImage\": true,\n      \"osType\": \"Ubuntu 22.04\",\n      \"osArchitecture\": \"x86_64\",\n      \"osPlatform\": \"Linux/UNIX\",\n      \"osDistribution\": \"0001-com-ubuntu-server-jammy:22_04-lts-gen2\",\n      \"osDiskType\": \"NA\",\n      \"osDiskSizeGB\": -1,\n      \"imageStatus\": \"Available\",\n      \"details\": [\n        {\n          \"key\": \"Location\",\n          \"value\": \"AustraliaCentral\"\n        },\n        {\n          \"key\": \"Name\",\n          \"value\": \"22.04.202507300\"\n        },\n        {\n          \"key\": \"ID\",\n          \"value\": \"/Subscriptions/4512d933-bc3f-401e-9738-17ba29428eb5/Providers/Microsoft.Compute/Locations/AustraliaCentral/Publishers/Canonical/ArtifactTypes/VMImage/Offers/0001-com-ubuntu-server-jammy/Skus/22_04-lts-gen2/Versions/22.04.202507300\"\n        },\n        {\n          \"key\": \"Properties\",\n          \"value\": \"{architecture:x64,automaticOSUpgradeProperties:{automaticOSUpgradeSupported:false},dataDiskImages:[],disallowed:{vmDiskType:Unmanaged},features:[{name:SecurityType,value:TrustedLaunchSupported},{name:IsAcceleratedNetworkSupported,value:True},{name:DiskControllerTypes,value:SCSI, NVMe},{name:IsHibernateSupported,value:True}],hyperVGeneration:V2,imageDeprecationStatus:{imageState:Active},osDiskImage:{operatingSystem:Linux}}\"\n        }\n      ],\n      \"systemLabel\": \"from-assets\"\n    }\n  ],\n  \"targetSecurityGroupList\": [\n    {\n      \"name\": \"mig-sg-01\",\n      \"connectionName\": \"azure-koreacentral\",\n      \"vNetId\": \"mig-vnet-01\",\n      \"description\": \"Recommended security group for cb95f7e4-570c-468c-af77-2263271bc138\",\n      \"firewallRules\": [\n        {\n          \"Ports\": \"22\",\n          \"Protocol\": \"tcp\",\n          \"Direction\": \"inbound\",\n          \"CIDR\": \"0.0.0.0/0\"\n        }\n      ],\n      \"cspResourceId\": \"\"\n    }\n  ]\n}\n\n",
            "path_params": {
              "nsId": "mig01"
            }
          },
          {
            "name": "send_result_via_email",
            "task_component": "trigger_email",
            "dependencies": [
              "infra_migration"
            ]
          }
        ]
      }
    ]
  }
}
